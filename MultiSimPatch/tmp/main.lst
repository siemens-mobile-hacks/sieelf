##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    05/Dec/2011  21:21:55 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  D:\SVN\SieELF\SieELF\MultiSimPatch\MultiSimElf\main. #
#                       c                                                    #
#    Command line    =  D:\SVN\SieELF\SieELF\MultiSimPatch\MultiSimElf\main. #
#                       c -D NEWSGOLD -lC D:\SVN\SieELF\SieELF\MultiSimPatch #
#                       \tmp\ -lA D:\SVN\SieELF\SieELF\MultiSimPatch\tmp\    #
#                       -o D:\SVN\SieELF\SieELF\MultiSimPatch\tmp\ -s9       #
#                       --no_unroll --cpu_mode arm --endian little --cpu     #
#                       ARM926EJ-S --stack_align 4 --interwork -e --fpu      #
#                       None -I "D:\Program Files\IAR\Embedded Workbench     #
#                       4.0 Evaluation\ARM\INC\" --inline_threshold=2        #
#    List file       =  D:\SVN\SieELF\SieELF\MultiSimPatch\tmp\main.lst      #
#    Object file     =  D:\SVN\SieELF\SieELF\MultiSimPatch\tmp\main.r79      #
#                                                                            #
#                                                                            #
##############################################################################

D:\SVN\SieELF\SieELF\MultiSimPatch\MultiSimElf\main.c
      1          #include "..\..\inc\swilib.h"
      2          //#include "..\..\inc\xtask_ipc.h"
      3          #include "mainmenu.h"
      4          #include "..\multisim_ipc.h"
      5          //#include "..\inc\swilib.h"
      6          #include "conf_loader.h"
      7          
      8          extern void kill_data(void *p, void (*func_p)(void *));
      9          extern const unsigned int onc_ena;
     10          extern const unsigned int onc_sim;
     11          extern const unsigned int onc_sim2;\

   \                                 In segment DATA_Z, align 4, align-sorted
     12            int curblock=0;;
   \                     curblock:
   \   00000000                      DS8 4

   \                                 In segment DATA_Z, align 4, align-sorted
     13          int maincsm;
   \                     maincsm:
   \   00000000                      DS8 4
     14          int patchversion=0;
   \                     patchversion:
   \   00000004                      DS8 4
     15          
     16          //unsigned char bp[1024];

   \                                 In segment DATA_Z, align 4, align-sorted
     17               IPC_REQ gipc;
   \                     gipc:
   \   00000000                      DS8 12
     18          

   \                                 In segment DATA_C, align 4, align-sorted
     19          const int minus11=-11;
   \                     minus11:
   \   00000000   F5FFFFFF           DC32 -11
     20          
     21          //__root int xxx=123;
     22          //volatile static int yyy;

   \                                 In segment DATA_Z, align 4, align-sorted
     23          IPC_REQ gipc2;
   \                     gipc2:
   \   00000000                      DS8 12

   \                                 In segment CODE, align 4, keep-with-next
     24           void SendRequest(int submess, void *data){
     25                gipc2.name_to=IPC_MSIM_NAME;
   \                     SendRequest:
   \   00000000   30309FE5           LDR      R3,??SendRequest_0  ;; gipc2
   \   00000004   ........           LDR      R2,??DataTable7  ;; `?<Constant "MultiSim">`
   \   00000008   00402DE9           PUSH     {LR}
   \   0000000C   002083E5           STR      R2,[R3, #+0]
     26                gipc2.name_from=ELF_MSIM_NAME;
   \   00000010   0C2082E2           ADD      R2,R2,#+12
   \   00000014   042083E5           STR      R2,[R3, #+4]
     27                gipc2.data=data;
   \   00000018   081083E5           STR      R1,[R3, #+8]
     28                GBS_SendMessage(MMI_CEPID,MSG_IPC,submess,&gipc2);
   \   0000001C   0020A0E1           MOV      R2,R0
   \   00000020   B010A0E3           MOV      R1,#+176
   \   00000024   DE1C81E3           ORR      R1,R1,#0xDE00
   \   00000028   0900A0E3           MOV      R0,#+9
   \   0000002C   420C80E3           ORR      R0,R0,#0x4200
   \   00000030   000100EF           SWI      +256
     29          
     30          
     31          }
   \   00000034   0080BDE8           POP      {PC}             ;; return
   \                     ??SendRequest_0:
   \   00000038   ........           DC32     gipc2
     32          

   \                                 In segment CODE, align 4, keep-with-next
     33           void ChangeSim( int num)
     34          {
     35            SendRequest(IPC_MSIM_SWITCH,(void*)num);
   \                     ChangeSim:
   \   00000000   0010A0E1           MOV      R1,R0
   \   00000004   0100A0E3           MOV      R0,#+1
   \   00000008   ........           B        SendRequest      ;; tailcall
     36          //  RefreshGUI();
     37          
     38          }
     39          
     40          
     41          typedef struct
     42          {
     43            CSM_RAM csm;
     44            int gui_id;
     45          }MAIN_CSM;
     46          
     47          
     48          inline void ReadConfig(){
     49            InitConfig();
     50          }
     51          
     52          extern int simnum;
     53          extern int simcnt;
     54          extern int WriteFile(char *, unsigned char *,int );
     55          extern const char f5401s[];
     56          extern const char f5402s[];
     57          //char buf5401[0x30*20];

   \                                 In segment DATA_Z, align 4, align-sorted
     58          BLOCK5401 block5401[MAX_SIM_CNT];
   \                     block5401:
   \   00000000                      DS8 960

   \                                 In segment CODE, align 4, keep-with-next
     59          void Get5401(void){
     60            simnum=0;
   \                     Get5401:
   \   00000000   ........           LDR      R1,??DataTable3  ;; simnum
   \   00000004   10402DE9           PUSH     {R4,LR}
     61            EEFullReadBlock(5403,&simnum,0x2F,1,0,0);
     62          
     63            EEFullReadBlock(5401,&block5401,0,BL_SZ_5401,0,0);
   \   00000008   78409FE5           LDR      R4,??Get5401_0   ;; block5401
   \   0000000C   0000A0E3           MOV      R0,#+0
   \   00000010   000081E5           STR      R0,[R1, #+0]
   \   00000014   01002DE9           PUSH     {R0}
   \   00000018   01002DE9           PUSH     {R0}
   \   0000001C   0130A0E3           MOV      R3,#+1
   \   00000020   2F20A0E3           MOV      R2,#+47
   \   00000024   1B00A0E3           MOV      R0,#+27
   \   00000028   540D80E3           ORR      R0,R0,#0x1500
   \   0000002C   860000EF           SWI      +134
   \   00000030   0000A0E3           MOV      R0,#+0
   \   00000034   01002DE9           PUSH     {R0}
   \   00000038   01002DE9           PUSH     {R0}
   \   0000003C   F03FA0E3           MOV      R3,#+960
   \   00000040   0020A0E3           MOV      R2,#+0
   \   00000044   0410A0E1           MOV      R1,R4
   \   00000048   1900A0E3           MOV      R0,#+25
   \   0000004C   540D80E3           ORR      R0,R0,#0x1500
   \   00000050   860000EF           SWI      +134
     64            int i;
     65            for (i=0;i<20&&(block5401[i].SPN[1]!=0);i++);
   \   00000054   0000A0E3           MOV      R0,#+0
   \   00000058   10D08DE2           ADD      SP,SP,#+16
   \                     ??Get5401_1:
   \   0000005C   3010A0E3           MOV      R1,#+48
   \   00000060   914022E0           MLA      R2,R1,R0,R4
   \   00000064   2110D2E5           LDRB     R1,[R2, #+33]
   \   00000068   000051E3           CMP      R1,#+0
   \   0000006C   0200000A           BEQ      ??Get5401_2
   \   00000070   010080E2           ADD      R0,R0,#+1
   \   00000074   140050E3           CMP      R0,#+20
   \   00000078   F7FFFFBA           BLT      ??Get5401_1
     66            simcnt=i;
   \                     ??Get5401_2:
   \   0000007C   08109FE5           LDR      R1,??Get5401_0+0x4  ;; simcnt
   \   00000080   000081E5           STR      R0,[R1, #+0]
     67          }
   \   00000084   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??Get5401_0:
   \   00000088   ........           DC32     block5401
   \   0000008C   ........           DC32     simcnt
     68          

   \                                 In segment CODE, align 4, keep-with-next
     69          void maincsm_oncreate(CSM_RAM *data)
     70          {
   \                     maincsm_oncreate:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
     71          //  MAIN_GUI *main_gui=malloc(sizeof(MAIN_GUI));
     72            MAIN_CSM*csm=(MAIN_CSM*)data;
     73          //  zeromem(main_gui,sizeof(MAIN_GUI));
     74            /*
     75            main_gui->gui.canvas=(void *)(&Canvas);
     76            main_gui->gui.flag30=2;
     77            main_gui->gui.methods=(void *)gui_methods;
     78            main_gui->gui.item_ll.data_mfree=(void (*)(void *))mfree_adr();
     79           */
     80            csm->csm.state=0;
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   100084E5           STR      R0,[R4, #+16]
     81            csm->csm.unk1=0;
   \   00000010   140084E5           STR      R0,[R4, #+20]
     82          ///  csm->gui_id=CreateGUI(main_gui);
     83          //  csm->gui_id=    ShowMainMenu();
     84          //  maincsm=
     85            Get5401();
   \   00000014   ........           BL       Get5401
     86                      if (!onc_ena){
   \   00000018   ........           LDR      R0,??DataTable5  ;; onc_ena
   \   0000001C   000090E5           LDR      R0,[R0, #+0]
   \   00000020   000050E3           CMP      R0,#+0
   \   00000024   0300001A           BNE      ??maincsm_oncreate_0
     87                      csm->gui_id=    ShowMainMenu();
   \   00000028   ........           _BLF     ShowMainMenu,??ShowMainMenu??rA
   \   0000002C   280084E5           STR      R0,[R4, #+40]
     88                      RefreshGUI();
   \   00000030   960100EF           SWI      +406
   \   00000034   1080BDE8           POP      {R4,PC}
     89                    }else{
     90                      if (simnum==onc_sim)ChangeSim(onc_sim2);else
   \                     ??maincsm_oncreate_0:
   \   00000038   20009FE5           LDR      R0,??maincsm_oncreate_1  ;; onc_sim
   \   0000003C   001090E5           LDR      R1,[R0, #+0]
   \   00000040   ........           LDR      R0,??DataTable3  ;; simnum
   \   00000044   000090E5           LDR      R0,[R0, #+0]
   \   00000048   010050E1           CMP      R0,R1
   \   0000004C   10009F05           LDREQ    R0,??maincsm_oncreate_1+0x4  ;; onc_sim2
   \   00000050   00109005           LDREQ    R1,[R0, #+0]
     91                        ChangeSim(onc_sim);
   \   00000054   0100A0E3           MOV      R0,#+1
   \   00000058   1040BDE8           POP      {R4,LR}          ;; Pop
   \   0000005C   ........           B        SendRequest      ;; tailcall
   \                     ??maincsm_oncreate_1:
   \   00000060   ........           DC32     onc_sim
   \   00000064   ........           DC32     onc_sim2
     92                    }
     93          }
     94          

   \                                 In segment CODE, align 4, keep-with-next
     95          void ELF_KILLER(void)
     96          {
   \                     ELF_KILLER:
   \   00000000   00402DE9           PUSH     {LR}
     97            extern void *ELF_BEGIN;
     98            kill_data(&ELF_BEGIN,(void (*)(void *))mfree_adr());
   \   00000004   158000EF           SWI      +32789
   \   00000008   0010A0E1           MOV      R1,R0
   \   0000000C   04009FE5           LDR      R0,??ELF_KILLER_0  ;; ELF_BEGIN
   \   00000010   0040BDE8           POP      {LR}             ;; Pop
   \   00000014   ........           _BF      kill_data,??kill_data??rA  ;; tailcall
   \                     ??ELF_KILLER_0:
   \   00000018   ........           DC32     ELF_BEGIN
     99          }
    100          

   \                                 In segment CODE, align 4, keep-with-next
    101          void maincsm_onclose(CSM_RAM *csm)
    102          {
    103            SUBPROC((void *)ELF_KILLER);
   \                     maincsm_onclose:
   \   00000000   08009FE5           LDR      R0,??maincsm_onclose_0  ;; ELF_KILLER
   \   00000004   00402DE9           PUSH     {LR}
   \   00000008   710100EF           SWI      +369
    104          }
   \   0000000C   0080BDE8           POP      {PC}             ;; return
   \                     ??maincsm_onclose_0:
   \   00000010   ........           DC32     ELF_KILLER
    105          
    106          
    107          

   \                                 In segment CODE, align 4, keep-with-next
    108          int maincsm_onmessage(CSM_RAM *data, GBS_MSG *msg)
    109          {
   \                     maincsm_onmessage:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    110            MAIN_CSM *csm=(MAIN_CSM*)data;
    111            if(msg->msg == MSG_RECONFIGURE_REQ)
   \   00000004   ........           LDR      R6,??DataTable7  ;; `?<Constant "MultiSim">`
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0150A0E1           MOV      R5,R1
   \   00000010   040095E5           LDR      R0,[R5, #+4]
   \   00000014   AF10A0E3           MOV      R1,#+175
   \   00000018   DE1C81E3           ORR      R1,R1,#0xDE00
   \   0000001C   010050E1           CMP      R0,R1
   \   00000020   0900001A           BNE      ??maincsm_onmessage_0
    112            {
    113              extern const char *successed_config_filename;
    114              if (strcmp(successed_config_filename,(char *)msg->data0)==0)
   \   00000024   B4009FE5           LDR      R0,??maincsm_onmessage_1  ;; successed_config_filename
   \   00000028   0C1095E5           LDR      R1,[R5, #+12]
   \   0000002C   000090E5           LDR      R0,[R0, #+0]
   \   00000030   190000EF           SWI      +25
   \   00000034   000050E3           CMP      R0,#+0
   \   00000038   0300001A           BNE      ??maincsm_onmessage_0
    115          //    if (strcmp_nocase(successed_config_filename,(char *)msg->data0)==0)
    116              {
    117                ShowMSG(1,(int)"一卡多号配置已更新!");
   \   0000003C   181086E2           ADD      R1,R6,#+24
   \   00000040   0100A0E3           MOV      R0,#+1
   \   00000044   480100EF           SWI      +328
    118                ReadConfig();
   \   00000048   ........           _BLF     InitConfig,??InitConfig??rA
    119              }
    120          
    121            }
    122          
    123            if (msg->msg==MSG_IPC)
   \                     ??maincsm_onmessage_0:
   \   0000004C   040095E5           LDR      R0,[R5, #+4]
   \   00000050   B010A0E3           MOV      R1,#+176
   \   00000054   DE1C81E3           ORR      R1,R1,#0xDE00
   \   00000058   010050E1           CMP      R0,R1
   \   0000005C   1300001A           BNE      ??maincsm_onmessage_2
    124            {
    125              IPC_REQ *ipc;
    126              if ((ipc=(IPC_REQ*)msg->data0))
   \   00000060   0C0095E5           LDR      R0,[R5, #+12]
   \   00000064   000050E3           CMP      R0,#+0
   \   00000068   1A00000A           BEQ      ??maincsm_onmessage_3
    127              {
    128                if (strcmp(ipc->name_from,IPC_MSIM_NAME)==0)
   \   0000006C   040090E5           LDR      R0,[R0, #+4]
   \   00000070   0610A0E1           MOV      R1,R6
   \   00000074   190000EF           SWI      +25
   \   00000078   000050E3           CMP      R0,#+0
    129                {
    130          
    131          	switch (msg->submess)
   \   0000007C   08009505           LDREQ    R0,[R5, #+8]
   \   00000080   0A005003           CMPEQ    R0,#+10
   \   00000084   0900001A           BNE      ??maincsm_onmessage_2
    132          	{
    133          	case IPC_MSIM_SWITCHED:
    134                    if (onc_ena){
   \   00000088   ........           LDR      R0,??DataTable5  ;; onc_ena
   \   0000008C   000090E5           LDR      R0,[R0, #+0]
   \   00000090   000050E3           CMP      R0,#+0
   \   00000094   0300000A           BEQ      ??maincsm_onmessage_4
    135                        CloseCSM(maincsm);
   \   00000098   ........           LDR      R0,??DataTable8  ;; maincsm
   \   0000009C   000090E5           LDR      R0,[R0, #+0]
   \   000000A0   FC0100EF           SWI      +508
   \   000000A4   010000EA           B        ??maincsm_onmessage_2
    136                    }else
    137                      GeneralFuncF1(1);
   \                     ??maincsm_onmessage_4:
   \   000000A8   0100A0E3           MOV      R0,#+1
   \   000000AC   3B0100EF           SWI      +315
    138          	  break;
    139          	}
    140          
    141                }
    142              }
    143            }
    144            if ((msg->msg==MSG_GUI_DESTROYED)&&((int)msg->data0==csm->gui_id))
   \                     ??maincsm_onmessage_2:
   \   000000B0   040095E5           LDR      R0,[R5, #+4]
   \   000000B4   0E10A0E3           MOV      R1,#+14
   \   000000B8   641C81E3           ORR      R1,R1,#0x6400
   \   000000BC   010050E1           CMP      R0,R1
   \   000000C0   0400001A           BNE      ??maincsm_onmessage_3
   \   000000C4   0C0095E5           LDR      R0,[R5, #+12]
   \   000000C8   281094E5           LDR      R1,[R4, #+40]
   \   000000CC   010050E1           CMP      R0,R1
    145            {
    146              csm->csm.state=-3;
   \   000000D0   0200E003           MVNEQ    R0,#+2
   \   000000D4   10008405           STREQ    R0,[R4, #+16]
    147            }
    148            return(1);
   \                     ??maincsm_onmessage_3:
   \   000000D8   0100A0E3           MOV      R0,#+1
   \   000000DC   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??maincsm_onmessage_1:
   \   000000E0   ........           DC32     successed_config_filename
    149          }
    150          

   \                                 In segment DATA_Z, align 4, align-sorted
    151          unsigned short maincsm_name_body[140];
   \                     maincsm_name_body:
   \   00000000                      DS8 280
    152          
    153          const struct
    154          {
    155            CSM_DESC maincsm;
    156            WSHDR maincsm_name;

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "MultiSim">`:
   \   00000000   4D756C746953       DC8 "MultiSim"
   \              696D00      
   \   00000009   000000             DC8 0, 0, 0
   \   0000000C   4D756C746953       DC8 "MultiSimElf"
   \              696D456C6600
   \   00000018   D2BBBFA8B6E0       DC8 "\322\273\277\250\266\340\272\305\305\344\326\303\322\321\270\374\320\302!"
   \              BAC5C5E4D6C3
   \              D2D1B8FCD0C2
   \              2100        
    157          }MAINCSM =
   \                     MAINCSM:
   \   0000002C   ............       DC32 maincsm_onmessage, maincsm_oncreate, 0, 0, 0, 0, maincsm_onclose
   \              ....00000000
   \              000000000000
   \              000000000000
   \              ........    
   \   00000048   2C0000000100       DC32 44, 1, minus11, maincsm_name_body, 55AACCCCH, 3333AA55H, 0
   \              0000........
   \              ........CCCC
   \              AA5555AA3333
   \              00000000    
   \   00000064   8B00               DC16 139
   \   00000066   0000               DC8 0, 0
    158          {
    159            {
    160              maincsm_onmessage,
    161              maincsm_oncreate,
    162          #ifdef NEWSGOLD
    163          0,
    164          0,
    165          0,
    166          0,
    167          #endif
    168          maincsm_onclose,
    169          sizeof(MAIN_CSM),
    170          1,
    171          &minus11
    172            },
    173            {
    174              maincsm_name_body,
    175              NAMECSM_MAGIC1,
    176              NAMECSM_MAGIC2,
    177              0x0,
    178              139
    179            }
    180          };
    181          

   \                                 In segment CODE, align 4, keep-with-next
    182          void UpdateCSMname(void)
    183          {
    184            wsprintf((WSHDR *)(&MAINCSM.maincsm_name),ELF_MSIM_NAME);
   \                     UpdateCSMname:
   \   00000000   ........           LDR      R0,??DataTable7  ;; `?<Constant "MultiSim">`
   \   00000004   00402DE9           PUSH     {LR}
   \   00000008   0C1080E2           ADD      R1,R0,#+12
   \   0000000C   540080E2           ADD      R0,R0,#+84
   \   00000010   240100EF           SWI      +292
    185          }
   \   00000014   0080BDE8           POP      {PC}             ;; return
    186          
    187          

   \                                 In segment CODE, align 4, keep-with-next
    188          void UpdateTesters(){
   \                     UpdateTesters:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
    189            unsigned char *block5401=(unsigned char*)malloc(0x50*20);
    190            EEFullCreateBlock(5403,BL_SZ_5403,1,0,0);
    191            EEFullReadBlock(5402,block5401,0,BL_SZ_5403,0,0);
    192            WriteFile("0:\\misc\\5402.bak",block5401,BL_SZ_5403);
   \   00000004   B4719FE5           LDR      R7,??UpdateTesters_0  ;; `?<Constant "0:\\\\misc\\\\5402.bak">`
   \   00000008   640EA0E3           MOV      R0,#+1600
   \   0000000C   1B50A0E3           MOV      R5,#+27
   \   00000010   140000EF           SWI      +20
   \   00000014   0040A0E1           MOV      R4,R0
   \   00000018   0000A0E3           MOV      R0,#+0
   \   0000001C   01002DE9           PUSH     {R0}
   \   00000020   545D85E3           ORR      R5,R5,#0x1500
   \   00000024   0030A0E3           MOV      R3,#+0
   \   00000028   0120A0E3           MOV      R2,#+1
   \   0000002C   5010A0E3           MOV      R1,#+80
   \   00000030   0500A0E1           MOV      R0,R5
   \   00000034   3A0200EF           SWI      +570
   \   00000038   0000A0E3           MOV      R0,#+0
   \   0000003C   01002DE9           PUSH     {R0}
   \   00000040   01002DE9           PUSH     {R0}
   \   00000044   0160C5E3           BIC      R6,R5,#0x1
   \   00000048   5030A0E3           MOV      R3,#+80
   \   0000004C   0020A0E1           MOV      R2,R0
   \   00000050   0410A0E1           MOV      R1,R4
   \   00000054   0600A0E1           MOV      R0,R6
   \   00000058   860000EF           SWI      +134
   \   0000005C   5020A0E3           MOV      R2,#+80
   \   00000060   0410A0E1           MOV      R1,R4
   \   00000064   0700A0E1           MOV      R0,R7
   \   00000068   ........           _BLF     WriteFile,??WriteFile??rA
    193            EEFullWriteBlock(5403,block5401,0,0x50,0,0);
   \   0000006C   0000A0E3           MOV      R0,#+0
   \   00000070   01002DE9           PUSH     {R0}
   \   00000074   01002DE9           PUSH     {R0}
   \   00000078   5030A0E3           MOV      R3,#+80
   \   0000007C   0020A0E1           MOV      R2,R0
   \   00000080   0410A0E1           MOV      R1,R4
   \   00000084   0500A0E1           MOV      R0,R5
   \   00000088   870000EF           SWI      +135
    194            EEFullDeleteBlock(5402,0,0);
   \   0000008C   0020A0E3           MOV      R2,#+0
   \   00000090   0210A0E1           MOV      R1,R2
   \   00000094   0600A0E1           MOV      R0,R6
   \   00000098   390200EF           SWI      +569
    195          
    196            EEFullCreateBlock(5402,BL_SZ_5402,1,0,0);
   \   0000009C   0000A0E3           MOV      R0,#+0
   \   000000A0   01002DE9           PUSH     {R0}
   \   000000A4   0030A0E1           MOV      R3,R0
   \   000000A8   0120A0E3           MOV      R2,#+1
   \   000000AC   641EA0E3           MOV      R1,#+1600
   \   000000B0   0600A0E1           MOV      R0,R6
   \   000000B4   3A0200EF           SWI      +570
    197            EEFullReadBlock(5401,block5401,0,BL_SZ_5402,0,0);
   \   000000B8   0000A0E3           MOV      R0,#+0
   \   000000BC   01002DE9           PUSH     {R0}
   \   000000C0   01002DE9           PUSH     {R0}
   \   000000C4   0250C5E3           BIC      R5,R5,#0x2
   \   000000C8   643EA0E3           MOV      R3,#+1600
   \   000000CC   0020A0E1           MOV      R2,R0
   \   000000D0   0410A0E1           MOV      R1,R4
   \   000000D4   0500A0E1           MOV      R0,R5
   \   000000D8   860000EF           SWI      +134
    198            WriteFile("0:\\misc\\5401.bak",block5401,BL_SZ_5402);
   \   000000DC   642EA0E3           MOV      R2,#+1600
   \   000000E0   0410A0E1           MOV      R1,R4
   \   000000E4   140087E2           ADD      R0,R7,#+20
   \   000000E8   ........           _BLF     WriteFile,??WriteFile??rA
    199            EEFullWriteBlock(5402,block5401,0,BL_SZ_5402,0,0);
   \   000000EC   0000A0E3           MOV      R0,#+0
   \   000000F0   01002DE9           PUSH     {R0}
   \   000000F4   01002DE9           PUSH     {R0}
   \   000000F8   643EA0E3           MOV      R3,#+1600
   \   000000FC   0020A0E1           MOV      R2,R0
   \   00000100   0410A0E1           MOV      R1,R4
   \   00000104   0600A0E1           MOV      R0,R6
   \   00000108   870000EF           SWI      +135
   \   0000010C   28D08DE2           ADD      SP,SP,#+40
    200            EEFullDeleteBlock(5401,0,0);
   \   00000110   0020A0E3           MOV      R2,#+0
   \   00000114   0210A0E1           MOV      R1,R2
   \   00000118   0500A0E1           MOV      R0,R5
   \   0000011C   390200EF           SWI      +569
    201          
    202            EEFullCreateBlock(5401,BL_SZ_5401,1,0,0);
   \   00000120   0000A0E3           MOV      R0,#+0
   \   00000124   01002DE9           PUSH     {R0}
   \   00000128   0030A0E1           MOV      R3,R0
   \   0000012C   0120A0E3           MOV      R2,#+1
   \   00000130   F01FA0E3           MOV      R1,#+960
   \   00000134   0500A0E1           MOV      R0,R5
   \   00000138   3A0200EF           SWI      +570
    203            EEFullReadBlock(5400,block5401,0,BL_SZ_5401,0,0);
   \   0000013C   0000A0E3           MOV      R0,#+0
   \   00000140   01002DE9           PUSH     {R0}
   \   00000144   01002DE9           PUSH     {R0}
   \   00000148   0160C5E3           BIC      R6,R5,#0x1
   \   0000014C   F03FA0E3           MOV      R3,#+960
   \   00000150   0020A0E1           MOV      R2,R0
   \   00000154   0410A0E1           MOV      R1,R4
   \   00000158   0600A0E1           MOV      R0,R6
   \   0000015C   860000EF           SWI      +134
    204            WriteFile("0:\\misc\\5400.bak",block5401,BL_SZ_5401);
   \   00000160   F02FA0E3           MOV      R2,#+960
   \   00000164   0410A0E1           MOV      R1,R4
   \   00000168   280087E2           ADD      R0,R7,#+40
   \   0000016C   ........           _BLF     WriteFile,??WriteFile??rA
    205            EEFullWriteBlock(5401,block5401,0,BL_SZ_5401,0,0);
   \   00000170   0000A0E3           MOV      R0,#+0
   \   00000174   01002DE9           PUSH     {R0}
   \   00000178   01002DE9           PUSH     {R0}
   \   0000017C   F03FA0E3           MOV      R3,#+960
   \   00000180   0020A0E1           MOV      R2,R0
   \   00000184   0410A0E1           MOV      R1,R4
   \   00000188   0500A0E1           MOV      R0,R5
   \   0000018C   870000EF           SWI      +135
    206            EEFullDeleteBlock(5400,0,0);
   \   00000190   0020A0E3           MOV      R2,#+0
   \   00000194   0210A0E1           MOV      R1,R2
   \   00000198   0600A0E1           MOV      R0,R6
   \   0000019C   390200EF           SWI      +569
    207          
    208            ShowMSG(1,(int)"块5400-5402已移除. 更新补丁到最新") ;
   \   000001A0   3C1087E2           ADD      R1,R7,#+60
   \   000001A4   0100A0E3           MOV      R0,#+1
   \   000001A8   480100EF           SWI      +328
    209            mfree(block5401);
   \   000001AC   0400A0E1           MOV      R0,R4
   \   000001B0   150000EF           SWI      +21
    210            SwitchPhoneOff();
   \   000001B4   090000EF           SWI      +9
    211          };
   \   000001B8   14D08DE2           ADD      SP,SP,#+20
   \   000001BC   F080BDE8           POP      {R4-R7,PC}       ;; return
   \                     ??UpdateTesters_0:
   \   000001C0   ........           DC32     `?<Constant "0:\\\\misc\\\\5402.bak">`
    212          

   \                                 In segment CODE, align 4, keep-with-next
    213          void UpdateFromOld() {
   \                     UpdateFromOld:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
    214           unsigned char *block5400=(unsigned char*)malloc(1024);
    215           unsigned char *block5401=(unsigned char*)malloc(0x50*20);
    216          
    217           EEFullReadBlock(5400, block5400, 0, 1024, 0, 0);
    218           memset(block5401, 0, 0x50*20);
    219           memcpy(block5401+0x21, "物理卡", 8);
   \   00000004   60729FE5           LDR      R7,??UpdateFromOld_0  ;; `?<Constant "\\316\\357\\300\\355\\277\\250">`
   \   00000008   400EA0E3           MOV      R0,#+1024
   \   0000000C   1860A0E3           MOV      R6,#+24
   \   00000010   140000EF           SWI      +20
   \   00000014   0040A0E1           MOV      R4,R0
   \   00000018   640EA0E3           MOV      R0,#+1600
   \   0000001C   140000EF           SWI      +20
   \   00000020   0050A0E1           MOV      R5,R0
   \   00000024   0000A0E3           MOV      R0,#+0
   \   00000028   01002DE9           PUSH     {R0}
   \   0000002C   01002DE9           PUSH     {R0}
   \   00000030   546D86E3           ORR      R6,R6,#0x1500
   \   00000034   403EA0E3           MOV      R3,#+1024
   \   00000038   0020A0E3           MOV      R2,#+0
   \   0000003C   0410A0E1           MOV      R1,R4
   \   00000040   0600A0E1           MOV      R0,R6
   \   00000044   860000EF           SWI      +134
   \   00000048   642EA0E3           MOV      R2,#+1600
   \   0000004C   0010A0E3           MOV      R1,#+0
   \   00000050   0500A0E1           MOV      R0,R5
   \   00000054   BB0000EF           SWI      +187
   \   00000058   0820A0E3           MOV      R2,#+8
   \   0000005C   0710A0E1           MOV      R1,R7
   \   00000060   210085E2           ADD      R0,R5,#+33
   \   00000064   1E0100EF           SWI      +286
    220          
    221           for (int i=0; i<10; i++) {
   \   00000068   0080A0E3           MOV      R8,#+0
   \   0000006C   08D08DE2           ADD      SP,SP,#+8
    222            memcpy(block5401+0x30*(i+1),      block5400+0x50*i,      0x0C);//imsi
   \                     ??UpdateFromOld_1:
   \   00000070   3000A0E3           MOV      R0,#+48
   \   00000074   905829E0           MLA      R9,R0,R8,R5
   \   00000078   5000A0E3           MOV      R0,#+80
   \   0000007C   90482AE0           MLA      R10,R0,R8,R4
   \   00000080   0C20A0E3           MOV      R2,#+12
   \   00000084   0A10A0E1           MOV      R1,R10
   \   00000088   300089E2           ADD      R0,R9,#+48
   \   0000008C   1E0100EF           SWI      +286
    223            memcpy(block5401+0x30*(i+1)+0x10, block5400+0x50*i+0x10, 0x10);//ki
   \   00000090   1020A0E3           MOV      R2,#+16
   \   00000094   10108AE2           ADD      R1,R10,#+16
   \   00000098   400089E2           ADD      R0,R9,#+64
   \   0000009C   1E0100EF           SWI      +286
    224            memcpy(block5401+0x30*(i+1)+0x20, block5400+0x50*i+0x20, 0x10);//name
   \   000000A0   1020A0E3           MOV      R2,#+16
   \   000000A4   20108AE2           ADD      R1,R10,#+32
   \   000000A8   500089E2           ADD      R0,R9,#+80
   \   000000AC   1E0100EF           SWI      +286
    225           }
   \   000000B0   018088E2           ADD      R8,R8,#+1
   \   000000B4   0A0058E3           CMP      R8,#+10
   \   000000B8   ECFFFFBA           BLT      ??UpdateFromOld_1
    226           EEFullCreateBlock(5401, 0x30*20, 1, 0, 0);
   \   000000BC   0000A0E3           MOV      R0,#+0
   \   000000C0   01002DE9           PUSH     {R0}
   \   000000C4   018086E3           ORR      R8,R6,#0x1
   \   000000C8   0030A0E3           MOV      R3,#+0
   \   000000CC   0120A0E3           MOV      R2,#+1
   \   000000D0   F01FA0E3           MOV      R1,#+960
   \   000000D4   0800A0E1           MOV      R0,R8
   \   000000D8   3A0200EF           SWI      +570
    227           EEFullWriteBlock(5401, block5401, 0, 0x30*20, 0, 0);//5401 done!
   \   000000DC   0000A0E3           MOV      R0,#+0
   \   000000E0   01002DE9           PUSH     {R0}
   \   000000E4   01002DE9           PUSH     {R0}
   \   000000E8   F03FA0E3           MOV      R3,#+960
   \   000000EC   0020A0E1           MOV      R2,R0
   \   000000F0   0510A0E1           MOV      R1,R5
   \   000000F4   0800A0E1           MOV      R0,R8
   \   000000F8   870000EF           SWI      +135
    228          
    229          
    230           for (int i=0; i<20; i++) {//prepare 5402
   \   000000FC   0080A0E3           MOV      R8,#+0
   \   00000100   0CD08DE2           ADD      SP,SP,#+12
    231            memset(block5401+0x50*i,      0xFF, 0x2F);
   \                     ??UpdateFromOld_2:
   \   00000104   5000A0E3           MOV      R0,#+80
   \   00000108   905829E0           MLA      R9,R0,R8,R5
   \   0000010C   2F20A0E3           MOV      R2,#+47
   \   00000110   FF10A0E3           MOV      R1,#+255
   \   00000114   0900A0E1           MOV      R0,R9
   \   00000118   BB0000EF           SWI      +187
    232            memset(block5401+0x50*i+0x30, 0x00, 0x20);
   \   0000011C   2020A0E3           MOV      R2,#+32
   \   00000120   0010A0E3           MOV      R1,#+0
   \   00000124   300089E2           ADD      R0,R9,#+48
   \   00000128   BB0000EF           SWI      +187
    233            block5401[0x50*i+0x2F]=(unsigned char)i;
   \   0000012C   2F80C9E5           STRB     R8,[R9, #+47]
    234           }
   \   00000130   018088E2           ADD      R8,R8,#+1
   \   00000134   140058E3           CMP      R8,#+20
   \   00000138   F1FFFFBA           BLT      ??UpdateFromOld_2
    235          
    236           //physical sim data
    237           memcpy(block5401,      block5400+0x340, 0x10);//loci
   \   0000013C   1020A0E3           MOV      R2,#+16
   \   00000140   D01F84E2           ADD      R1,R4,#+832
   \   00000144   0500A0E1           MOV      R0,R5
   \   00000148   1E0100EF           SWI      +286
    238           memcpy(block5401+0x4C, block5400+0x331, 0x04);//profiles
   \   0000014C   0420A0E3           MOV      R2,#+4
   \   00000150   3100A0E3           MOV      R0,#+49
   \   00000154   C00F80E3           ORR      R0,R0,#0x300
   \   00000158   041080E0           ADD      R1,R0,R4
   \   0000015C   4C0085E2           ADD      R0,R5,#+76
   \   00000160   1E0100EF           SWI      +286
    239          
    240           for (int i=0; i<10; i++) {
   \   00000164   0080A0E3           MOV      R8,#+0
    241            memcpy(block5401+0x50*(i+1),      block5400+0x50*i+0x40, 0x10);//loci
   \                     ??UpdateFromOld_3:
   \   00000168   5010A0E3           MOV      R1,#+80
   \   0000016C   910800E0           MUL      R0,R1,R8
   \   00000170   1020A0E3           MOV      R2,#+16
   \   00000174   059080E0           ADD      R9,R0,R5
   \   00000178   04A080E0           ADD      R10,R0,R4
   \   0000017C   40108AE2           ADD      R1,R10,#+64
   \   00000180   500089E2           ADD      R0,R9,#+80
   \   00000184   1E0100EF           SWI      +286
    242            memcpy(block5401+0x50*(i+1)+0x30, block5400+0x50*i+0x30, 0x10);//smsc
   \   00000188   1020A0E3           MOV      R2,#+16
   \   0000018C   30108AE2           ADD      R1,R10,#+48
   \   00000190   800089E2           ADD      R0,R9,#+128
   \   00000194   1E0100EF           SWI      +286
    243            memcpy(block5401+0x50*(i+1)+0x4C, block5400+0x50*i+0x0C, 0x04);//profiles
   \   00000198   0420A0E3           MOV      R2,#+4
   \   0000019C   0C108AE2           ADD      R1,R10,#+12
   \   000001A0   9C0089E2           ADD      R0,R9,#+156
   \   000001A4   1E0100EF           SWI      +286
    244           }
   \   000001A8   018088E2           ADD      R8,R8,#+1
   \   000001AC   0A0058E3           CMP      R8,#+10
   \   000001B0   ECFFFFBA           BLT      ??UpdateFromOld_3
    245          
    246           EEFullCreateBlock(5402, 0x50*20, 1, 0, 0);
   \   000001B4   0000A0E3           MOV      R0,#+0
   \   000001B8   01002DE9           PUSH     {R0}
   \   000001BC   028086E3           ORR      R8,R6,#0x2
   \   000001C0   0030A0E3           MOV      R3,#+0
   \   000001C4   0120A0E3           MOV      R2,#+1
   \   000001C8   641EA0E3           MOV      R1,#+1600
   \   000001CC   0800A0E1           MOV      R0,R8
   \   000001D0   3A0200EF           SWI      +570
    247           EEFullWriteBlock(5402, block5401, 0, 0x50*20, 0, 0);
   \   000001D4   0000A0E3           MOV      R0,#+0
   \   000001D8   01002DE9           PUSH     {R0}
   \   000001DC   01002DE9           PUSH     {R0}
   \   000001E0   643EA0E3           MOV      R3,#+1600
   \   000001E4   0020A0E1           MOV      R2,R0
   \   000001E8   0510A0E1           MOV      R1,R5
   \   000001EC   0800A0E1           MOV      R0,R8
   \   000001F0   870000EF           SWI      +135
    248          
    249           EEFullCreateBlock(5403, 0x50, 1, 0, 0);
   \   000001F4   0000A0E3           MOV      R0,#+0
   \   000001F8   01002DE9           PUSH     {R0}
   \   000001FC   038086E3           ORR      R8,R6,#0x3
   \   00000200   0030A0E1           MOV      R3,R0
   \   00000204   0120A0E3           MOV      R2,#+1
   \   00000208   5010A0E3           MOV      R1,#+80
   \   0000020C   0800A0E1           MOV      R0,R8
   \   00000210   3A0200EF           SWI      +570
    250           EEFullWriteBlock(5403, block5401, 0, 0x50, 0, 0);
   \   00000214   0000A0E3           MOV      R0,#+0
   \   00000218   01002DE9           PUSH     {R0}
   \   0000021C   01002DE9           PUSH     {R0}
   \   00000220   5030A0E3           MOV      R3,#+80
   \   00000224   0020A0E1           MOV      R2,R0
   \   00000228   0510A0E1           MOV      R1,R5
   \   0000022C   0800A0E1           MOV      R0,R8
   \   00000230   870000EF           SWI      +135
    251          
    252           EEFullDeleteBlock(5400, 0, 0);
   \   00000234   0020A0E3           MOV      R2,#+0
   \   00000238   0210A0E1           MOV      R1,R2
   \   0000023C   0600A0E1           MOV      R0,R6
   \   00000240   390200EF           SWI      +569
    253          
    254           ShowMSG(1,(int)"块5401-5403已创建. 更新补丁到最新");
   \   00000244   081087E2           ADD      R1,R7,#+8
   \   00000248   0100A0E3           MOV      R0,#+1
   \   0000024C   480100EF           SWI      +328
    255           mfree(block5400);
   \   00000250   0400A0E1           MOV      R0,R4
   \   00000254   150000EF           SWI      +21
    256           mfree(block5401);
   \   00000258   0500A0E1           MOV      R0,R5
   \   0000025C   150000EF           SWI      +21
    257           SwitchPhoneOff();
   \   00000260   090000EF           SWI      +9
    258          };
   \   00000264   18D08DE2           ADD      SP,SP,#+24
   \   00000268   F087BDE8           POP      {R4-R10,PC}      ;; return
   \                     ??UpdateFromOld_0:
   \   0000026C   ........           DC32     `?<Constant "\\316\\357\\300\\355\\277\\250">`
    259          
    260          extern int ReadFile(char *name);
    261          extern unsigned char bp[BL_SZ_5402];
    262          //todo

   \                                 In segment CODE, align 4, keep-with-next
    263          void CreateBlocksFromFiles(){
   \                     CreateBlocksFromFiles:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    264          
    265            if (ReadFile("0:\\misc\\5401.txt")==BL_SZ_5401){
   \   00000004   30419FE5           LDR      R4,??CreateBlocksFromFiles_0  ;; bp
   \   00000008   30519FE5           LDR      R5,??CreateBlocksFromFiles_0+0x4  ;; `?<Constant "\\277\\3515401\\322\\321\\264\\264\\275\\2`
   \   0000000C   100085E2           ADD      R0,R5,#+16
   \   00000010   ........           _BLF     ReadFile,??ReadFile??rA
   \   00000014   F00F50E3           CMP      R0,#+960
   \   00000018   1400001A           BNE      ??CreateBlocksFromFiles_1
    266              EEFullCreateBlock(5401,BL_SZ_5401,1,0,0);
   \   0000001C   0000A0E3           MOV      R0,#+0
   \   00000020   01002DE9           PUSH     {R0}
   \   00000024   1960A0E3           MOV      R6,#+25
   \   00000028   546D86E3           ORR      R6,R6,#0x1500
   \   0000002C   0030A0E3           MOV      R3,#+0
   \   00000030   0120A0E3           MOV      R2,#+1
   \   00000034   F01FA0E3           MOV      R1,#+960
   \   00000038   0600A0E1           MOV      R0,R6
   \   0000003C   3A0200EF           SWI      +570
    267              EEFullWriteBlock(5401, bp, 0, BL_SZ_5401,0,0);
   \   00000040   0000A0E3           MOV      R0,#+0
   \   00000044   01002DE9           PUSH     {R0}
   \   00000048   01002DE9           PUSH     {R0}
   \   0000004C   F03FA0E3           MOV      R3,#+960
   \   00000050   0020A0E1           MOV      R2,R0
   \   00000054   0410A0E1           MOV      R1,R4
   \   00000058   0600A0E1           MOV      R0,R6
   \   0000005C   870000EF           SWI      +135
    268               ShowMSG(1,(int)"块5401已创建.") ;
   \   00000060   0510A0E1           MOV      R1,R5
   \   00000064   0100A0E3           MOV      R0,#+1
   \   00000068   480100EF           SWI      +328
   \   0000006C   0CD08DE2           ADD      SP,SP,#+12
    269            }
    270            if (ReadFile("0:\\misc\\5402.txt")==BL_SZ_5402){
   \                     ??CreateBlocksFromFiles_1:
   \   00000070   340085E2           ADD      R0,R5,#+52
   \   00000074   ........           _BLF     ReadFile,??ReadFile??rA
   \   00000078   640E50E3           CMP      R0,#+1600
   \   0000007C   1400001A           BNE      ??CreateBlocksFromFiles_2
    271              EEFullCreateBlock(5402,BL_SZ_5402,1,0,0);
   \   00000080   0000A0E3           MOV      R0,#+0
   \   00000084   01002DE9           PUSH     {R0}
   \   00000088   1A60A0E3           MOV      R6,#+26
   \   0000008C   546D86E3           ORR      R6,R6,#0x1500
   \   00000090   0030A0E3           MOV      R3,#+0
   \   00000094   0120A0E3           MOV      R2,#+1
   \   00000098   641EA0E3           MOV      R1,#+1600
   \   0000009C   0600A0E1           MOV      R0,R6
   \   000000A0   3A0200EF           SWI      +570
    272              EEFullWriteBlock(5402, bp, 0, BL_SZ_5402,0,0);
   \   000000A4   0000A0E3           MOV      R0,#+0
   \   000000A8   01002DE9           PUSH     {R0}
   \   000000AC   01002DE9           PUSH     {R0}
   \   000000B0   643EA0E3           MOV      R3,#+1600
   \   000000B4   0020A0E1           MOV      R2,R0
   \   000000B8   0410A0E1           MOV      R1,R4
   \   000000BC   0600A0E1           MOV      R0,R6
   \   000000C0   870000EF           SWI      +135
    273               ShowMSG(1,(int)"块5402已创建.") ;
   \   000000C4   241085E2           ADD      R1,R5,#+36
   \   000000C8   0100A0E3           MOV      R0,#+1
   \   000000CC   480100EF           SWI      +328
   \   000000D0   0CD08DE2           ADD      SP,SP,#+12
    274            }
    275            if (ReadFile("0:\\misc\\5403.txt")==BL_SZ_5403){
   \                     ??CreateBlocksFromFiles_2:
   \   000000D4   580085E2           ADD      R0,R5,#+88
   \   000000D8   ........           _BLF     ReadFile,??ReadFile??rA
   \   000000DC   500050E3           CMP      R0,#+80
   \   000000E0   7080BD18           POPNE    {R4-R6,PC}
    276              EEFullCreateBlock(5403,BL_SZ_5403,1,0,0);
   \   000000E4   0000A0E3           MOV      R0,#+0
   \   000000E8   01002DE9           PUSH     {R0}
   \   000000EC   1B60A0E3           MOV      R6,#+27
   \   000000F0   546D86E3           ORR      R6,R6,#0x1500
   \   000000F4   0030A0E3           MOV      R3,#+0
   \   000000F8   0120A0E3           MOV      R2,#+1
   \   000000FC   5010A0E3           MOV      R1,#+80
   \   00000100   0600A0E1           MOV      R0,R6
   \   00000104   3A0200EF           SWI      +570
    277              EEFullWriteBlock(5403, bp, 0, BL_SZ_5403,0,0);
   \   00000108   0000A0E3           MOV      R0,#+0
   \   0000010C   01002DE9           PUSH     {R0}
   \   00000110   01002DE9           PUSH     {R0}
   \   00000114   5030A0E3           MOV      R3,#+80
   \   00000118   0020A0E1           MOV      R2,R0
   \   0000011C   0410A0E1           MOV      R1,R4
   \   00000120   0600A0E1           MOV      R0,R6
   \   00000124   870000EF           SWI      +135
    278               ShowMSG(1,(int)"块5403已创建.") ;
   \   00000128   481085E2           ADD      R1,R5,#+72
   \   0000012C   0100A0E3           MOV      R0,#+1
   \   00000130   480100EF           SWI      +328
   \   00000134   0CD08DE2           ADD      SP,SP,#+12
    279            }
    280          
    281          };
   \   00000138   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??CreateBlocksFromFiles_0:
   \   0000013C   ........           DC32     bp
   \   00000140   ........           DC32     `?<Constant "\\277\\3515401\\322\\321\\264\\264\\275\\2`
    282          

   \                                 In segment CODE, align 4, keep-with-next
    283          int main()
    284          {
   \                     main:
   \   00000000   10402DE9           PUSH     {R4,LR}
    285              int sz;
    286              char ver;
    287            patchversion=EEFullGetBlockInfo(5402,&sz,&ver);
   \   00000004   ........           LDR      R4,??DataTable8  ;; maincsm
   \   00000008   34D04DE2           SUB      SP,SP,#+52
   \   0000000C   0D20A0E1           MOV      R2,SP
   \   00000010   04108DE2           ADD      R1,SP,#+4
   \   00000014   1A00A0E3           MOV      R0,#+26
   \   00000018   540D80E3           ORR      R0,R0,#0x1500
   \   0000001C   2C0000EF           SWI      +44
   \   00000020   040084E5           STR      R0,[R4, #+4]
    288            if (!patchversion&&ver==0){patchversion=1;// old beta testers
   \   00000024   000050E3           CMP      R0,#+0
   \   00000028   0500001A           BNE      ??main_0
   \   0000002C   0000DDE5           LDRB     R0,[SP, #+0]
   \   00000030   000050E3           CMP      R0,#+0
   \   00000034   1500001A           BNE      ??main_1
   \   00000038   0100A0E3           MOV      R0,#+1
   \   0000003C   040084E5           STR      R0,[R4, #+4]
    289              UpdateTesters();
   \   00000040   ........           BL       UpdateTesters
    290            }
    291            if (patchversion==2){//block not exist
   \                     ??main_0:
   \   00000044   040094E5           LDR      R0,[R4, #+4]
   \   00000048   020050E3           CMP      R0,#+2
   \   0000004C   0B00001A           BNE      ??main_2
    292              patchversion=EEFullGetBlockInfo(5400,&sz,&ver)+2;
   \   00000050   0D20A0E1           MOV      R2,SP
   \   00000054   04108DE2           ADD      R1,SP,#+4
   \   00000058   1800A0E3           MOV      R0,#+24
   \   0000005C   540D80E3           ORR      R0,R0,#0x1500
   \   00000060   2C0000EF           SWI      +44
   \   00000064   020080E2           ADD      R0,R0,#+2
   \   00000068   040084E5           STR      R0,[R4, #+4]
    293              if(patchversion==2)UpdateFromOld();else
   \   0000006C   020050E3           CMP      R0,#+2
   \   00000070   0100001A           BNE      ??main_3
   \   00000074   ........           BL       UpdateFromOld
   \   00000078   000000EA           B        ??main_2
    294                CreateBlocksFromFiles();
   \                     ??main_3:
   \   0000007C   ........           BL       CreateBlocksFromFiles
    295          
    296            }
    297            if (patchversion)return 4;
   \                     ??main_2:
   \   00000080   040094E5           LDR      R0,[R4, #+4]
   \   00000084   000050E3           CMP      R0,#+0
   \   00000088   0400A013           MOVNE    R0,#+4
   \   0000008C   0900001A           BNE      ??main_4
    298              /*
    299                0-- good
    300                1-- // old beta testers
    301                2- block5400  present
    302                4- block5400 not present
    303            */
    304          
    305            ReadConfig();
   \                     ??main_1:
   \   00000090   ........           _BLF     InitConfig,??InitConfig??rA
    306          
    307            char dummy[sizeof(MAIN_CSM)];
    308            UpdateCSMname();
   \   00000094   ........           BL       UpdateCSMname
    309            LockSched();
   \   00000098   460100EF           SWI      +326
    310          
    311          
    312            maincsm=CreateCSM(&MAINCSM.maincsm,dummy,0);
   \   0000009C   1C009FE5           LDR      R0,??main_5      ;; `?<Constant "MultiSim">` + 44
   \   000000A0   0020A0E3           MOV      R2,#+0
   \   000000A4   08108DE2           ADD      R1,SP,#+8
   \   000000A8   070100EF           SWI      +263
   \   000000AC   000084E5           STR      R0,[R4, #+0]
    313          
    314            UnlockSched();
   \   000000B0   470100EF           SWI      +327
    315          
    316            return 0;
   \   000000B4   0000A0E3           MOV      R0,#+0
   \                     ??main_4:
   \   000000B8   34D08DE2           ADD      SP,SP,#+52       ;; stack cleaning
   \   000000BC   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??main_5:
   \   000000C0   ........           DC32     `?<Constant "MultiSim">` + 44
    317          
    318          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable3:
   \   00000000   ........           DC32     simnum

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable5:
   \   00000000   ........           DC32     onc_ena

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable7:
   \   00000000   ........           DC32     `?<Constant "MultiSim">`

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable8:
   \   00000000   ........           DC32     maincsm

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "0:\\\\misc\\\\5402.bak">`:
   \   00000000   303A5C6D6973       DC8 "0:\\misc\\5402.bak"
   \              635C35343032
   \              2E62616B00  
   \   00000011   000000             DC8 0, 0, 0
   \   00000014   303A5C6D6973       DC8 "0:\\misc\\5401.bak"
   \              635C35343031
   \              2E62616B00  
   \   00000025   000000             DC8 0, 0, 0
   \   00000028   303A5C6D6973       DC8 "0:\\misc\\5400.bak"
   \              635C35343030
   \              2E62616B00  
   \   00000039   000000             DC8 0, 0, 0
   \   0000003C   BFE935343030       DC8 "\277\3515400-5402\322\321\322\306\263\375. \270\374\320\302\262\271\266\241\265\275\327\356\320\302"
   \              2D35343032D2
   \              D1D2C6B3FD2E
   \              20B8FCD0C2B2
   \              B9B6A1B5BDD7
   \              EED0C200    
   \   0000005E   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\316\\357\\300\\355\\277\\250">`:
   \   00000000   CEEFC0EDBFA8       DC8 "\316\357\300\355\277\250"
   \              00          
   \   00000007   00                 DC8 0
   \   00000008   BFE935343031       DC8 "\277\3515401-5403\322\321\264\264\275\250. \270\374\320\302\262\271\266\241\265\275\327\356\320\302"
   \              2D35343033D2
   \              D1B4B4BDA82E
   \              20B8FCD0C2B2
   \              B9B6A1B5BDD7
   \              EED0C200    
   \   0000002A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\277\\3515401\\322\\321\\264\\264\\275\\2`:
   \   00000000   BFE935343031       DC8 "\277\3515401\322\321\264\264\275\250."
   \              D2D1B4B4BDA8
   \              2E00        
   \   0000000E   0000               DC8 0, 0
   \   00000010   303A5C6D6973       DC8 "0:\\misc\\5401.txt"
   \              635C35343031
   \              2E74787400  
   \   00000021   000000             DC8 0, 0, 0
   \   00000024   BFE935343032       DC8 "\277\3515402\322\321\264\264\275\250."
   \              D2D1B4B4BDA8
   \              2E00        
   \   00000032   0000               DC8 0, 0
   \   00000034   303A5C6D6973       DC8 "0:\\misc\\5402.txt"
   \              635C35343032
   \              2E74787400  
   \   00000045   000000             DC8 0, 0, 0
   \   00000048   BFE935343033       DC8 "\277\3515403\322\321\264\264\275\250."
   \              D2D1B4B4BDA8
   \              2E00        
   \   00000056   0000               DC8 0, 0
   \   00000058   303A5C6D6973       DC8 "0:\\misc\\5403.txt"
   \              635C35343033
   \              2E74787400  
   \   00000069   000000             DC8 0, 0, 0
    319          
    320          //---------------------------------------------------------------------------
    321          // Test menu
    322          //---------------------------------------------------------------------------
    323          

   Maximum stack usage in bytes:

     Function              CSTACK
     --------              ------
     ChangeSim                 4
     CreateBlocksFromFiles    28
     ELF_KILLER                4
     Get5401                  24
     SendRequest               4
     UpdateCSMname             4
     UpdateFromOld            56
     UpdateTesters            60
     main                     60
     maincsm_onclose           4
     maincsm_oncreate          8
     maincsm_onmessage        16


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     curblock                          4
     maincsm                           8
     gipc                             12
     minus11                           4
     gipc2                            12
     SendRequest                      60
     ChangeSim                        12
     block5401                       960
     Get5401                         144
     maincsm_oncreate                104
     ELF_KILLER                       28
     maincsm_onclose                  20
     maincsm_onmessage               228
     maincsm_name_body               280
     ?<Constant "MultiSim">          104
     UpdateCSMname                    24
     UpdateTesters                   452
     UpdateFromOld                   624
     CreateBlocksFromFiles           324
     main                            196
     ??DataTable3                      4
     ??DataTable5                      4
     ??DataTable7                      4
     ??DataTable8                      4
     ?<Constant "0:\\misc\\5402.bak">
                                      96
     ?<Constant "\316\357\300\355\277\250">
                                      44
     ?<Constant "\277\3515401\322\321\264\264\275\2
                                     108
      Others                         120

 
 2 340 bytes in segment CODE
   356 bytes in segment DATA_C
 1 276 bytes in segment DATA_Z
    12 bytes in segment INITTAB
 
 2 232 bytes of CODE  memory (+ 120 bytes shared)
   356 bytes of CONST memory
 1 276 bytes of DATA  memory

Errors: none
Warnings: none
